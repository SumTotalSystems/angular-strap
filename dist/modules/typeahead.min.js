/**
 * angular-strap
 * @version v2.3.12 - 2020-09-29
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com> (https://github.com/mgcrea)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
'use strict';angular.module('mgcrea.ngStrap.typeahead',['mgcrea.ngStrap.tooltip','mgcrea.ngStrap.helpers.parseOptions']).provider('$typeahead',function(){var e=this.defaults={animation:'am-fade',prefixClass:'typeahead',prefixEvent:'$typeahead',placement:'bottom-left',templateUrl:'typeahead/typeahead.tpl.html',trigger:'focus',container:!1,keyboard:!0,html:!1,delay:0,minLength:1,filter:'bsAsyncFilter',limit:6,autoSelect:!1,comparator:'',trimValue:!0,translations:{resultsText:'suggestions',noResultsText:'no suggestions available',selectResultText:'you must select a value from the dropdown list'},selectedProperty:''},t={downArrow:40,enter:13,escape:27,upArrow:38,tab:9};this.$get=['$window','$rootScope','$tooltip','$$rAF','$timeout',function(n,a,i,o,r){function l(n,a,l){var c={},d=angular.extend({},e,l);c=i(n,d);var u=l.scope,$=c.$scope;$.id=d.id,$.$resetMatches=function(){$.$matches=[],$.$activeIndex=d.autoSelect?0:-1},$.$resetMatches(),$.$activate=function(e){$.$$postDigest(function(){c.activate(e)})},$.$select=function(e,t){$.$$postDigest(function(){c.select(e)})},$.$isVisible=function(){return c.$isVisible()},$.$isActive=function(e){return $.$activeIndex===e?!0:void 0},c.update=function(e){$.$matches=e,$.$activeIndex>=e.length&&($.$activeIndex=d.autoSelect?0:-1),s($),o(c.$applyPlacement)},c.setFeedbackMessage=function(e){var t=angular.element(document.getElementById($.$id+'_sr_text'));t&&(angular.element(t).text(e),setTimeout(function(){angular.element(t).text('')},2e3))},c.activate=function(e){$.$activeIndex=e},c.select=function(e){if(-1!==e){var t=$.$matches[e].value;'object'==typeof t&&void 0!==d.selectedProperty&&d.selectedProperty.length>0?a.$setViewValue(t[d.selectedProperty]):a.$setViewValue(t),a.$render(),$.$resetMatches(),u&&u.$digest(),$.$emit(d.prefixEvent+'.select',t,e,c),angular.isDefined(d.onSelect)&&angular.isFunction(d.onSelect)&&d.onSelect(t,e,c)}},c.$isVisible=function(){return d.minLength&&a?$.$matches.length&&angular.isString(a.$viewValue)&&a.$viewValue.length>=d.minLength:!!$.$matches.length},$.$generateResultId=function(e){return $.id?$.id+'_typeahead_result_'+e:void 0},c.$getIndex=function(e){var t;for(t=$.$matches.length;t--&&!angular.equals($.$matches[t].value,e););return t},c.$onMouseDown=function(e){e.preventDefault(),e.stopPropagation()},c.$$updateScrollTop=function(e,t){if(t>-1&&t<e.children.length){var n=e.children[t],a=n.offsetTop,i=n.offsetTop+n.clientHeight,o=e.scrollTop,r=e.scrollTop+e.clientHeight;i>=o&&o>a?e.scrollTop=Math.max(0,e.scrollTop-e.clientHeight):i>r&&(e.scrollTop=a)}},c.$onKeyDown=function(e){if(c.setAriaActiveDescendant(),/(38|40|13|27|9)/.test(e.keyCode)){if(!c.$isVisible()||e.keyCode===t.enter&&-1===$.$activeIndex||(e.preventDefault(),e.stopPropagation()),e.which===t.escape||e.which===t.tab){if(c.$isVisible()){var n=angular.fromJson(d.translations);return void c.setFeedbackMessage(n.selectResultText)}c.hide(),e.stopPropagation()}if(e.keyCode===t.enter&&$.$matches.length)c.select($.$activeIndex);else if(e.keyCode===t.upArrow&&$.$activeIndex>0)$.$activeIndex--,c.setAriaActiveDescendant($.$activeIndex);else if(e.keyCode===t.downArrow&&$.$activeIndex<$.$matches.length-1)$.$activeIndex++,c.setAriaActiveDescendant($.$activeIndex);else if(e.keyCode===t.upArrow&&0===$.$activeIndex||e.keyCode===t.downArrow&&$.$activeIndex===$.$matches.length-1){$.$activeIndex=-1;var i='#'+e.currentTarget.id;angular.element(i).val('').val(a.$viewValue),angular.element(i).focus()}else angular.isUndefined($.$activeIndex)&&($.$activeIndex=0,c.setAriaActiveDescendant());c.$$updateScrollTop(c.$element[0],$.$activeIndex),$.$digest()}};var p=c.show;c.show=function(){p(),r(function(){if(c.$element){if($.$id){c.$element.attr('id',$.$id+'_listbox'),n.attr('aria-controls',$.$id+'_listbox');var e=document.getElementById($.$id+'_sr_text');e||c.$element.parent().append('<div id="'+$.$id+'_sr_text" aria-live="assertive" style="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0;"></div>')}c.$element.attr('aria-labelledby',d.ariaLabelledby),c.$element.on('mousedown',c.$onMouseDown),d.keyboard&&(n&&n.off('keydown',c.$onKeyDown),n&&n.on('keydown',c.$onKeyDown))}},0,!1)};var f=c.hide;c.hide=function(){c.$element&&c.$element.off('mousedown',c.$onMouseDown),d.keyboard&&n&&n.off('keydown',c.$onKeyDown),d.autoSelect||c.activate(-1);var e=document.getElementById($.$id+'_sr_text');angular.element(e).remove(),c.setAriaActiveDescendant(),f()};c.$onKeyUp;c.$onKeyUp=function(e){e.which===t.escape&&c.$isShown&&(c.hide(),e.stopPropagation())};c.$onFocusKeyUp;return c.$onFocusKeyUp=function(e){e.which===t.escape&&(c.hide(),e.stopPropagation())},c.setAriaActiveDescendant=function(e){if(void 0!==e&&$.id){var t=$.$generateResultId(e);t?n.attr('aria-activedescendant',t):n.attr('aria-activedescendant','')}else n.attr('aria-activedescendant','')},c}function s(e){e.$$phase||e.$root&&e.$root.$$phase||e.$digest()}return l.defaults=e,l}]}).filter('bsAsyncFilter',['$filter',function(e){return function(t,n,a){return t&&angular.isFunction(t.then)?t.then(function(t){return e('filter')(t,n,a)}):e('filter')(t,n,a)}}]).directive('bsTypeahead',['$window','$parse','$q','$typeahead','$parseOptions',function(e,t,n,a,i){var o=a.defaults;return{restrict:'EAC',require:'ngModel',link:function(e,t,n,r){t.off('change');var l={scope:e};angular.forEach(['template','templateUrl','controller','controllerAs','placement','container','delay','trigger','keyboard','html','animation','filter','limit','minLength','watchOptions','selectMode','autoSelect','comparator','id','prefixEvent','prefixClass','ariaLabelledby','translations','selectedProperty'],function(e){angular.isDefined(n[e])&&(l[e]=n[e])});var s=/^(false|0|)$/i;angular.forEach(['html','container','trimValue','filter'],function(e){angular.isDefined(n[e])&&s.test(n[e])&&(l[e]=!1)}),angular.forEach(['onBeforeShow','onShow','onBeforeHide','onHide','onSelect'],function(t){var a='bs'+t.charAt(0).toUpperCase()+t.slice(1);angular.isDefined(n[a])&&(l[t]=e.$eval(n[a]))}),t.attr('autocomplete')||t.attr('autocomplete','off'),t.attr('aria-expanded',!1);var c=angular.isDefined(l.filter)?l.filter:o.filter,d=l.limit||o.limit,u=l.comparator||o.comparator,$=n.bsOptions;c&&($+=' | '+c+':$viewValue',u&&($+=':'+u)),d&&($+=' | limitTo:'+d);var p=i($),f=a(t,r,l);if(t.attr('aria-autocomplete')||$.templateUrl||t.attr('aria-autocomplete','list'),l.watchOptions){var h=p.$match[7].replace(/\|.+/,'').replace(/\(.*\)/g,'').trim();e.$watchCollection(h,function(t,n){p.valuesFn(e,r).then(function(e){f.update(e),r.$render()})})}e.$watch(n.ngModel,function(t,n){e.$modelValue=t,f.setAriaActiveDescendant(),p.valuesFn(e,r).then(function(e){return l.selectMode&&!e.length&&t.length>0?void r.$setViewValue(r.$viewValue.substring(0,r.$viewValue.length-1)):(e.length>d&&(e=e.slice(0,d)),f.update(e),void r.$render())})}),r.$formatters.push(function(e){var t=p.displayValue(e);return t?t:angular.isDefined(e)&&'object'!=typeof e?e:''}),r.$render=function(){if(r.$isEmpty(r.$viewValue))return t.val('');var e=f.$getIndex(r.$modelValue),n=-1!==e?f.$scope.$matches[e].label:r.$viewValue;n=angular.isObject(n)?p.displayValue(n):n;var a=n?n.toString().replace(/<(?:.|\n)*?>/gm,''):'',i=t[0].selectionStart,o=t[0].selectionEnd;if(t.val(l.trimValue===!1?a:a.trim()),t[0].setSelectionRange(i,o),void 0!==f.$scope.$matches&&n.length>=l.minLength){var s=angular.fromJson(l.translations);f.$scope.$matches.length>0?f.setFeedbackMessage(f.$scope.$matches.length+' '+s.resultsText):f.setFeedbackMessage(s.noResultsText)}t.attr('aria-expanded',f.$isVisible())},e.$on('$destroy',function(){t.off('keydown'),f&&f.destroy(),l=null,f=null})}}}]);
//# sourceMappingURL=typeahead.min.js.map
