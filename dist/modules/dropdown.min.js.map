{"version":3,"sources":["modules/dropdown.js"],"names":["angular","trigger","provider","container","this","defaults","keyboard","html","delay","placement","bodyEl","matchesSelector","DropdownFactory","$dropdown","options","element","config","onBodyClick","evt","directive","target","hide","attr","extend","scope","$new","$rootScope","$tooltip","$onKeyDown","parent","test","keyCode","stopPropagation","items","$element","querySelectorAll","length","preventDefault","index","focus","inMenu","el","i","relatedTarget","undefined","$onFocusOut","$window","document","body","show","$timeout","parentEl","hasClass","addClass","returnFocus","$isShown","off","removeClass","destroy","prototype","toUpperCase","webkitMatchesSelector","Element","mozMatchesSelector","msMatchesSelector","oMatchesSelector","tAttrs","nextSibling","nodeType","$sce","restrict","compile","template","templateUrl","parentNode","removeChild","forEach","falseValueRegExp","key","bsKey","isDefined","charAt","slice","$watch","newValue","oldValue","content","$eval","dropdown","isString","bsShow","match","$on"],"mappings":"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","file":"modules/dropdown.min.js","sourcesContent":["'use strict';\n\nangular.module('mgcrea.ngStrap.dropdown', ['mgcrea.ngStrap.tooltip'])\n\n  .provider('$dropdown', function () {\n\n    var defaults = this.defaults = {\n      animation: 'am-fade',\n      prefixClass: 'dropdown',\n      prefixEvent: 'dropdown',\n      placement: 'bottom-left',\n      templateUrl: 'dropdown/dropdown.tpl.html',\n      trigger: 'click',\n      container: false,\n      keyboard: true,\n      html: false,\n      delay: 0\n    };\n\n    this.$get = function ($window, $rootScope, $tooltip, $timeout) {\n\n      var bodyEl = angular.element($window.document.body);\n      var matchesSelector = Element.prototype.matchesSelector || Element.prototype.webkitMatchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector;\n\n      function DropdownFactory (element, config) {\n\n        var $dropdown = {};\n\n        // Common vars\n        var options = angular.extend({}, defaults, config);\n        /* var scope = */\n        $dropdown.$scope = options.scope && options.scope.$new() || $rootScope.$new();\n\n        $dropdown = $tooltip(element, options);\n        var parentEl = element.parent();\n\n        if (element && element[0] && element[0].tagName.toUpperCase() === 'BUTTON') {\n          element.attr('aria-haspopup', 'true');\n          element.attr('data-toggle', 'dropdown');\n          element.attr('aria-expanded', 'false');\n          element.attr('role', 'button');\n        }\n\n        // Protected methods\n\n        $dropdown.$onKeyDown = function (evt) {\n          if ((/(9)/.test(evt.keyCode) && !options.keyboard) || /27/.test(evt.keyCode)) {\n            $dropdown.hide(/27/.test(evt.keyCode));\n            return;\n          }\n          if (!/(38|40)/.test(evt.keyCode)) return;\n          evt.preventDefault();\n          evt.stopPropagation();\n\n          // Retrieve focused index\n          var items = angular.element($dropdown.$element[0].querySelectorAll('li:not(.divider) a'));\n          if (!items.length) return;\n          var index;\n          angular.forEach(items, function (el, i) {\n            if (matchesSelector && matchesSelector.call(el, ':focus')) index = i;\n          });\n\n          // Navigate with keyboard\n          if (evt.keyCode === 38 && index > 0) index--;\n          else if (evt.keyCode === 40 && index < items.length - 1) index++;\n          else if (evt.keyCode === 40 && index === items.length - 1) index = 0;\n          else if (angular.isUndefined(index)) index = 0;\n          items.eq(index)[0].focus();\n\n        };\n\n        $dropdown.$onFocusOut = function (evt) {\n          // find out if the related target's parents contain the datepicker's $element\n          var inMenu = false;\n          var parent = angular.element(evt.relatedTarget);\n          while (parent !== undefined && parent.length && parent[0] !== $window.document.body) {\n            parent = parent.parent();\n            if (parent !== undefined && parent[0] === $dropdown.$element[0]) {\n              inMenu = true;\n              break;\n            } else {\n              inMenu = false;\n            }\n          }\n\n          if (!inMenu) {\n            $dropdown.hide();\n          } else {\n            evt.preventDefault();\n            evt.stopPropagation();\n          }\n        };\n\n        // Overrides\n\n        var show = $dropdown.show;\n        $dropdown.show = function () {\n          show();\n          // use timeout to hookup the events to prevent\n          // event bubbling from being processed imediately.\n          $timeout(function () {\n            // Set assistive technology properties\n            element.attr('aria-expanded', 'true');\n            if ($dropdown.$element) {\n              $dropdown.$element.attr('aria-hidden', 'false');\n              $dropdown.$element.attr('role', 'menu');\n              $dropdown.$element.attr('tabindex', '-1');\n            }\n            if (options.keyboard && $dropdown.$element) {\n              $dropdown.$element.on('keydown', $dropdown.$onKeyDown);\n              $dropdown.$element.on('focusout', $dropdown.$onFocusOut);\n            }\n\n            bodyEl.on('click', onBodyClick);\n\n            if ($dropdown.$element) {\n              var items = angular.element($dropdown.$element[0].querySelectorAll('li:not(.divider)'));\n              items.attr('role', 'presentation');\n\n              angular.element($dropdown.$element[0].querySelectorAll('li.divider')).attr('role', 'seperator');\n\n              items = angular.element($dropdown.$element[0].querySelectorAll('li:not(.divider) a'));\n              items.attr('role', 'menuitem');\n              if (items.length && options.keyboard) {\n                items[0].focus();\n              }\n            }\n          }, 0, false);\n          if (parentEl.hasClass('dropdown')) parentEl.addClass('open');\n        };\n\n        var hide = $dropdown.hide;\n        $dropdown.hide = function (returnFocus) {\n          if (!$dropdown.$isShown) return;\n\n          element.attr('aria-expanded', 'true');\n          $dropdown.$element.attr('aria-hidden', 'true');\n\n          if (options.keyboard && $dropdown.$element) {\n            $dropdown.$element.off('keydown', $dropdown.$onKeyDown);\n            $dropdown.$element.off('focusout', $dropdown.$onFocusOut);\n          }\n\n          bodyEl.off('click', onBodyClick);\n          if (parentEl.hasClass('dropdown')) parentEl.removeClass('open');\n          $timeout(function () {\n            hide();\n            if (returnFocus) {\n              $timeout(function () {\n                if (element && element[0]) {\n                  element[0].focus();\n                }\n              }, 0, false);\n            }\n          }, 200);\n        };\n\n        var destroy = $dropdown.destroy;\n        $dropdown.destroy = function () {\n          bodyEl.off('click', onBodyClick);\n          destroy();\n        };\n\n        // Private functions\n\n        function onBodyClick (evt) {\n          if (evt.target === element[0]) return undefined;\n          return evt.target !== element[0] && $dropdown.hide();\n        }\n\n        return $dropdown;\n\n      }\n\n      return DropdownFactory;\n\n    };\n\n  })\n\n  .directive('bsDropdown', function ($window, $sce, $dropdown) {\n\n    return {\n      restrict: 'EAC',\n      scope: true,\n      compile: function (tElement, tAttrs) {\n\n        // Support for inlined template (next sibling)\n        // It must be fetched before compilation\n        if (!tAttrs.bsDropdown) {\n          var nextSibling = tElement[0].nextSibling;\n          while (nextSibling && nextSibling.nodeType !== 1) {\n            nextSibling = nextSibling.nextSibling;\n          }\n          if (nextSibling && nextSibling.className.split(' ').indexOf('dropdown-menu') >= 0) {\n            tAttrs.template = nextSibling.outerHTML;\n            tAttrs.templateUrl = undefined;\n            nextSibling.parentNode.removeChild(nextSibling);\n          }\n        }\n\n        return function postLink (scope, element, attr) {\n\n          // Directive options\n          var options = {\n            scope: scope\n          };\n          angular.forEach(['template', 'templateUrl', 'controller', 'controllerAs', 'placement', 'container', 'delay', 'trigger', 'keyboard', 'html', 'animation', 'id', 'autoClose'], function (key) {\n            if (angular.isDefined(tAttrs[key])) options[key] = tAttrs[key];\n          });\n\n          // use string regex match boolean attr falsy values, leave truthy values be\n          var falseValueRegExp = /^(false|0|)$/i;\n          angular.forEach(['html', 'container'], function (key) {\n            if (angular.isDefined(attr[key]) && falseValueRegExp.test(attr[key])) options[key] = false;\n          });\n\n          // bind functions from the attrs to the show and hide events\n          angular.forEach(['onBeforeShow', 'onShow', 'onBeforeHide', 'onHide'], function (key) {\n            var bsKey = 'bs' + key.charAt(0).toUpperCase() + key.slice(1);\n            if (angular.isDefined(attr[bsKey])) {\n              options[key] = scope.$eval(attr[bsKey]);\n            }\n          });\n\n          // Support scope as an object\n          if (attr.bsDropdown) {\n            scope.$watch(attr.bsDropdown, function (newValue, oldValue) {\n              scope.content = newValue;\n            }, true);\n          }\n\n          // Initialize dropdown\n          var dropdown = $dropdown(element, options);\n\n          // Visibility binding support\n          if (attr.bsShow) {\n            scope.$watch(attr.bsShow, function (newValue, oldValue) {\n              if (!dropdown || !angular.isDefined(newValue)) return;\n              if (angular.isString(newValue)) newValue = !!newValue.match(/true|,?(dropdown),?/i);\n              if (newValue === true) {\n                dropdown.show();\n              } else {\n                dropdown.hide();\n              }\n            });\n          }\n\n          // Garbage collection\n          scope.$on('$destroy', function () {\n            if (dropdown) dropdown.destroy();\n            options = null;\n            dropdown = null;\n          });\n\n        };\n      }\n    };\n\n  });\n"],"sourceRoot":"/source/"}